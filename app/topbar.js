"use client";
import React from "react";
import { auth, googleProvider } from "./firebaseConfig.js";
import { useState,useEffect } from "react";
import {useRouter} from 'next/navigation'
import logo from 'app/speedreedLogo.svg'
import {
  signInWithPopup,
  setPersistence,
  browserLocalPersistence,
} from "firebase/auth";
import { root } from "postcss";
function Topbar() {
  
  const [isAuth, setIsAuth] = useState(false)

  useEffect(() => {
    const unsubscribe = auth.onAuthStateChanged((user) => {
      setIsAuth(!!user);
    });
  
    // Cleanup the listener when the component unmounts
    return () => unsubscribe();
  }, []);
  
  return (
    <nav className="border-gray-200 bg-gray-50 dark:bg-gray-800 dark:border-gray-700">
      <div className="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-2">
        
        <a href="#" className="flex items-center">
        
          <svg
            xmlns="http://www.w3.org/2000/svg"
            xmlnsXlink="http://www.w3.org/1999/xlink"
            viewBox="-30 50 163 125"
            height={50}
            //hello
            width={70}
            data-background-color="#0092ff"
            preserveAspectRatio="xMidYMid meet"
            id="tight-bounds"
          >
            <g>
              <svg />
            </g>
            <g>
              <svg viewBox="0 0 125 225" height={225} width={125}>
                <g>
                  <path
                    xmlns="http://www.w3.org/2000/svg"
                    d="M62.431 175.058v0c-3.044 0-5.674-1.937-6.504-4.843-0.415-1.522-2.076-2.352-3.46-1.937-0.554 0.138-1.107 0.554-1.522 1.107-2.214 3.044-6.365 3.875-9.548 1.66-1.937-1.245-3.044-3.459-2.906-5.811 0-1.522-1.245-2.906-2.768-2.906-0.692 0-1.245 0.138-1.798 0.553-3.044 2.214-7.334 1.661-9.549-1.384-1.384-1.799-1.799-4.151-0.968-6.365 0.554-1.522-0.277-3.044-1.799-3.598-0.554-0.138-1.245-0.138-1.799 0-3.598 1.245-7.473-0.692-8.718-4.29-0.692-2.076-0.415-4.567 0.968-6.365 0.969-1.245 0.692-3.044-0.553-3.875-0.554-0.415-1.107-0.554-1.799-0.554-3.736 0.138-6.919-2.906-6.919-6.642 0-2.352 1.107-4.428 2.906-5.812 1.245-0.83 1.522-2.629 0.692-3.874-0.415-0.554-0.83-0.83-1.522-1.107-3.598-1.107-5.674-4.982-4.567-8.58 0.692-2.214 2.352-3.875 4.567-4.567 1.522-0.415 2.352-2.076 1.937-3.459-0.138-0.554-0.554-1.107-1.107-1.522-3.044-2.214-3.875-6.365-1.661-9.548 1.245-1.937 3.459-3.044 5.812-2.906 1.522 0 2.906-1.245 2.906-2.768 0-0.692-0.138-1.245-0.553-1.799-2.214-3.044-1.661-7.334 1.384-9.548 1.799-1.384 4.151-1.799 6.365-0.969 1.522 0.554 3.044-0.277 3.598-1.799 0.138-0.554 0.138-1.245 0-1.799-1.245-3.598 0.692-7.473 4.29-8.718 2.076-0.692 4.567-0.415 6.365 0.969 1.245 0.969 3.044 0.692 3.875-0.553 0.415-0.554 0.554-1.107 0.553-1.799-0.138-3.736 2.906-6.919 6.643-6.919 2.352 0 4.428 1.107 5.812 2.906 0.83 1.245 2.629 1.522 3.874 0.691 0.554-0.415 0.83-0.83 1.107-1.522 1.107-3.598 4.982-5.674 8.58-4.566 2.214 0.692 3.875 2.352 4.566 4.566v0c0.277 0.969 1.107 1.799 2.215 1.938 1.107 0.138 2.076-0.277 2.767-1.107 2.214-3.044 6.365-3.875 9.548-1.661 1.937 1.245 3.044 3.459 2.906 5.812 0 1.522 1.245 2.906 2.768 2.906 0.692 0 1.245-0.138 1.799-0.554 3.044-2.214 7.334-1.661 9.548 1.384 1.384 1.799 1.799 4.151 0.969 6.366-0.554 1.522 0.277 3.044 1.799 3.598 0.554 0.138 1.245 0.138 1.799 0 3.598-1.245 7.473 0.692 8.718 4.289 0.692 2.076 0.415 4.567-0.969 6.366-0.969 1.245-0.692 3.044 0.553 3.874 0.554 0.415 1.107 0.554 1.799 0.554 3.736-0.138 6.919 2.906 6.919 6.642 0 2.352-1.107 4.428-2.906 5.812-0.969 0.554-1.384 1.661-1.245 2.768 0.138 1.107 0.969 1.937 1.937 2.214 3.598 1.107 5.674 4.982 4.567 8.579-0.692 2.214-2.352 3.875-4.567 4.567-1.522 0.415-2.352 2.076-1.937 3.459 0.138 0.554 0.554 1.107 1.107 1.523 3.044 2.214 3.875 6.365 1.661 9.548-1.245 1.937-3.459 3.044-5.812 2.906-1.107 0-2.076 0.554-2.63 1.522-0.554 0.969-0.415 2.076 0.277 3.044 2.214 3.044 1.661 7.334-1.384 9.549-1.799 1.384-4.151 1.799-6.365 0.968-1.522-0.554-3.044 0.277-3.598 1.799-0.138 0.554-0.138 1.245 0 1.799 1.245 3.598-0.692 7.473-4.29 8.718-2.076 0.692-4.567 0.415-6.365-0.969-1.245-0.969-3.044-0.692-3.875 0.554-0.415 0.554-0.554 1.107-0.553 1.799 0.138 3.736-2.906 6.919-6.643 6.919-2.352 0-4.428-1.107-5.812-2.906-0.554-0.83-1.661-1.384-2.767-1.107-1.107 0.138-1.937 0.969-2.214 1.937-0.83 2.906-3.459 4.843-6.504 4.843zM53.159 164.265c0.415 0 0.692 0 1.107 0.138 2.629 0.415 4.705 2.214 5.397 4.705 0.415 1.522 2.076 2.352 3.46 1.799 0.83-0.277 1.522-0.969 1.799-1.799 1.107-3.598 4.982-5.674 8.579-4.566 1.384 0.415 2.768 1.384 3.598 2.629 0.969 1.245 2.629 1.522 4.013 0.553 0.692-0.554 1.107-1.384 1.107-2.214-0.138-3.736 2.906-6.919 6.642-6.919 1.522 0 3.044 0.415 4.29 1.384 1.245 0.969 3.044 0.692 3.875-0.553 0.554-0.692 0.692-1.799 0.415-2.63-1.245-3.598 0.554-7.473 4.151-8.718 1.522-0.554 3.044-0.554 4.567 0 1.522 0.554 3.044-0.277 3.598-1.799 0.277-0.83 0.138-1.937-0.415-2.629-2.214-3.044-1.661-7.334 1.383-9.548 1.245-0.969 2.768-1.384 4.29-1.384 1.522 0 2.768-1.245 2.906-2.767 0-0.969-0.415-1.799-1.245-2.353-3.044-2.214-3.875-6.365-1.661-9.548 0.83-1.245 2.076-2.214 3.598-2.629 1.522-0.415 2.352-2.076 1.799-3.46-0.277-0.83-0.969-1.522-1.799-1.799-3.598-1.107-5.674-4.982-4.566-8.579 0.415-1.384 1.384-2.768 2.629-3.598 1.245-0.969 1.522-2.768 0.553-4.013-0.554-0.692-1.384-1.107-2.214-1.107-3.736 0.138-6.919-2.906-6.919-6.642 0-1.522 0.415-3.044 1.384-4.29 0.969-1.245 0.692-3.044-0.554-3.875-0.692-0.554-1.799-0.692-2.629-0.415-3.598 1.245-7.473-0.554-8.718-4.151-0.554-1.522-0.554-3.044 0-4.567 0.554-1.522-0.277-3.044-1.799-3.598-0.83-0.277-1.937-0.138-2.629 0.415-3.044 2.214-7.334 1.661-9.548-1.384-0.969-1.245-1.384-2.768-1.384-4.289 0-1.522-1.245-2.768-2.906-2.768-0.83 0-1.799 0.415-2.214 1.107-2.214 3.044-6.365 3.875-9.548 1.661-1.245-0.83-2.214-2.076-2.629-3.598v0c-0.415-1.522-2.076-2.352-3.46-1.799-0.83 0.277-1.522 0.969-1.799 1.799-1.107 3.598-4.982 5.674-8.579 4.566-1.384-0.415-2.768-1.384-3.598-2.629-0.969-1.245-2.629-1.522-4.013-0.553-0.692 0.554-1.107 1.384-1.107 2.214 0.138 3.736-2.906 6.919-6.643 6.919-1.522 0-3.044-0.415-4.289-1.384-1.245-0.969-3.044-0.692-3.875 0.553-0.554 0.692-0.692 1.799-0.415 2.63 1.245 3.598-0.554 7.473-4.151 8.718-1.522 0.554-3.044 0.554-4.567 0-1.522-0.554-3.044 0.277-3.598 1.799-0.277 0.83-0.138 1.937 0.415 2.629 2.214 3.044 1.661 7.334-1.384 9.548-1.245 0.969-2.768 1.384-4.289 1.384-1.522 0-2.768 1.245-2.768 2.906 0 0.83 0.415 1.799 1.107 2.214 3.044 2.214 3.875 6.365 1.661 9.548-0.83 1.245-2.076 2.214-3.598 2.629-1.522 0.415-2.352 2.076-1.799 3.46 0.277 0.83 0.969 1.522 1.799 1.799 3.598 1.107 5.674 4.982 4.566 8.579-0.415 1.384-1.384 2.768-2.629 3.598-1.245 0.969-1.522 2.629-0.553 4.013 0.554 0.692 1.384 1.107 2.214 1.107 3.736-0.138 6.919 2.906 6.919 6.642 0 1.522-0.415 3.044-1.384 4.29-0.969 1.245-0.692 3.044 0.553 3.875 0.692 0.554 1.799 0.692 2.63 0.415 3.598-1.245 7.473 0.554 8.718 4.151 0.554 1.522 0.554 3.044 0 4.567-0.554 1.522 0.277 3.044 1.798 3.598 0.83 0.277 1.937 0.138 2.63-0.415 3.044-2.214 7.334-1.661 9.548 1.383 0.969 1.245 1.384 2.768 1.384 4.29 0 1.522 1.245 2.768 2.767 2.906 0.969 0 1.799-0.415 2.353-1.245 1.384-1.799 3.459-2.906 5.673-2.906z"
                    fill="#ffffff"
                    fillRule="nonzero"
                    stroke="none"
                    strokeWidth={1}
                    strokeLinecap="butt"
                    strokeLinejoin="miter"
                    strokeMiterlimit={10}
                    strokeDasharray=""
                    strokeDashoffset={0}
                    fontFamily="none"
                    fontWeight="none"
                    fontSize="none"
                    textAnchor="none"
                    style={{ mixBlendMode: "normal" }}
                    data-fill-palette-color="tertiary"
                  />
                </g>
                <g transform="matrix(1,0,0,1,36.9843375,93.27654963674124)">
                  <svg
                    viewBox="7 0 50.031325 68.446900726517526"
                    height="100"
                    width="100"
                  >
                    <g>
                      <svg
                        viewBox="0 0 31.031325 38.446900726517526"
                        height="38.446900726517526"
                        width="31.031325"
                      >
                        <g>
                          <svg
                            viewBox="0 0 31.031325 38.446900726517526"
                            height="38.446900726517526"
                            width="31.031325"
                          >
                            <g id="textblocktransform">
                              <svg
                                viewBox="0 0 31.031325 38.446900726517526"
                                height="38.446900726517526"
                                width="31.031325"
                                id="textblock"
                              >
                                <g>
                                  <svg
                                    viewBox="0 0 31.031325 38.446900726517526"
                                    height="38.446900726517526"
                                    width="31.031325"
                                  >
                                    <g>
                                      <svg
                                        viewBox="0 0 31.031325 38.446900726517526"
                                        height="38.446900726517526"
                                        width="31.031325"
                                      >
                                        <g>
                                          <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            xmlnsXlink="http://www.w3.org/1999/xlink"
                                            version="1.1"
                                            x={0}
                                            y={0}
                                            viewBox="14.821538925170898 11.595001220703125 65.6230239868164 81.30500030517578"
                                            enableBackground="new 0 0 100 100"
                                            xmlSpace="preserve"
                                            height="38.446900726517526"
                                            width="31.031325"
                                            className="icon-icon-0"
                                            data-fill-palette-color="accent"
                                            id="icon-0"
                                            fill="#ffffff"
                                          >
                                            <path
                                              fill="#ffffff"
                                              d="M30.608 44.241c-1.173 0.21-2.17 2.328-2.17 2.328L15.843 69.02c0 0-1.904 3.396-0.513 5.248 1.72 2.289 14.543 11.338 14.543 11.338l0.307-10.85-2.921-2.537 0.144-13.58 20.967 6.986 19.407-6.831v13.508l-3.001 4.19 0.337 9.175 13.067-9.329c0 0 2.142-1.635 2.263-4.116 0.167-3.417-13.099-25.032-13.099-25.032s-0.734-2.047-3.297-2.797C64.048 44.393 30.742 44.218 30.608 44.241z"
                                              data-fill-palette-color="accent"
                                            />
                                            <circle
                                              fill="#ffffff"
                                              cx="47.494"
                                              cy="26.81"
                                              r="15.215"
                                              data-fill-palette-color="accent"
                                            />
                                            <polygon
                                              fill="#ffffff"
                                              points="65.113,85.667 47.493,92.9 29.874,85.605 29.874,62.483 47.493,69.099 65.113,62.483 "
                                              data-fill-palette-color="accent"
                                            />
                                          </svg>
                                        </g>
                                      </svg>
                                    </g>
                                  </svg>
                                </g>
                              </svg>
                            </g>
                          </svg>
                        </g>
                        <g />
                      </svg>
                    </g>
                  </svg>
                </g>
              </svg>
            </g>
            <defs />
          </svg>

          <span className="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">
            SpeedReed
          </span>
        </a>
        {!isAuth ? (
          <LoginButton />
        ) : (
          <>
            <img
              className="w-10 h-10 rounded-full"
              src={auth.currentUser.photoURL}
              alt="Rounded avatar"
              
            />
          </>
        )}
      </div>
    </nav>
  );
}

export default Topbar;

export function LoginButton() {
  const router=useRouter()
  const signInwithGoogle = async () => {
    try {
      await signInWithPopup(auth, googleProvider);
      await setPersistence(result.user, browserLocalPersistence);
      router.refresh()
    } catch (error) {
      console.log(error);
    }
  };
  return (
    <button
      type="button"
      onClick={signInwithGoogle}
      className="text-white w-auto  bg-[#4285F4] hover:bg-[#4285F4]/90 focus:ring-4 focus:outline-none focus:ring-[#4285F4]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center justify-end dark:focus:ring-[#4285F4]/55 mr-2 mb-2"
    >
      <svg
        className="mr-2 -ml-1 w-4 h-4"
        aria-hidden="true"
        focusable="false"
        data-prefix="fab"
        data-icon="google"
        role="img"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 488 512"
      >
        <path
          fill="currentColor"
          d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"
        />
      </svg>
      Sign up
      <div />
    </button>
  );
}
